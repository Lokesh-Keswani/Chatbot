<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Chatbot</title>
    
    <!-- External Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" crossorigin="anonymous"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/uuid/8.3.2/uuid.min.js"></script>
    <!-- Load jsPDF with multiple fallback CDNs -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script>
        // Comprehensive jsPDF loading and initialization
        let jsPDFLoadAttempts = 0;
        const maxLoadAttempts = 3;
        
        function initializeJsPDF() {
            console.log('üìÑ Initializing jsPDF...');
            
            // Try to find jsPDF in various global locations
            let jsPDFFound = false;
            
            if (typeof window.jspdf !== 'undefined' && window.jspdf.jsPDF) {
                window.jsPDF = window.jspdf.jsPDF;
                jsPDFFound = true;
                console.log('‚úÖ jsPDF found at window.jspdf.jsPDF');
            } else if (typeof jsPDF !== 'undefined') {
                window.jsPDF = jsPDF;
                jsPDFFound = true;
                console.log('‚úÖ jsPDF found as global jsPDF');
            } else if (typeof window.jsPDF !== 'undefined') {
                jsPDFFound = true;
                console.log('‚úÖ jsPDF already available at window.jsPDF');
            }
            
            console.log('üìÑ jsPDF availability check:');
            console.log('  - window.jsPDF:', typeof window.jsPDF);
            console.log('  - window.jspdf:', typeof window.jspdf);
            console.log('  - jsPDF:', typeof jsPDF);
            console.log('  - window.jspdf.jsPDF:', typeof window.jspdf?.jsPDF);
            
            if (!jsPDFFound) {
                jsPDFLoadAttempts++;
                console.warn(`‚ö†Ô∏è jsPDF not found (attempt ${jsPDFLoadAttempts}/${maxLoadAttempts})`);
                
                if (jsPDFLoadAttempts < maxLoadAttempts) {
                    console.log('üîÑ Retrying jsPDF initialization in 500ms...');
                    setTimeout(initializeJsPDF, 500);
                } else {
                    console.error('‚ùå jsPDF failed to load after multiple attempts. Trying fallback CDN...');
                    loadJsPDFFallback();
                }
            } else {
                console.log('‚úÖ jsPDF initialized successfully');
                // Test if we can create a PDF instance
                try {
                    const testDoc = new window.jsPDF();
                    console.log('‚úÖ jsPDF test instance created successfully');
                } catch (error) {
                    console.error('‚ùå jsPDF test failed:', error);
                }
            }
        }
        
        function loadJsPDFFallback() {
            console.log('üîÑ Loading jsPDF fallback CDN...');
            const fallbackScript = document.createElement('script');
            fallbackScript.src = 'https://unpkg.com/jspdf@latest/dist/jspdf.umd.min.js';
            fallbackScript.onload = () => {
                console.log('üì¶ Fallback jsPDF loaded');
                setTimeout(initializeJsPDF, 100);
            };
            fallbackScript.onerror = () => {
                console.error('‚ùå Fallback jsPDF also failed to load');
                console.log('üí° PDF export will not be available. Please refresh the page.');
            };
            document.head.appendChild(fallbackScript);
        }
        
        // Initialize when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', () => {
                setTimeout(initializeJsPDF, 200);
            });
        } else {
            setTimeout(initializeJsPDF, 200);
        }
        
        // Also try to initialize when the script loads
        setTimeout(initializeJsPDF, 100);
    </script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    
    <!-- ResponsiveVoice for cloud-based multilingual TTS -->
    <script src="https://code.responsivevoice.org/responsivevoice.js?key=FREE"></script>
    <script>
        // Check ResponsiveVoice loading
        let rvCheckAttempts = 0;
        const maxRvAttempts = 10;
        
        function checkResponsiveVoice() {
            rvCheckAttempts++;
            
            if (typeof responsiveVoice !== 'undefined' && responsiveVoice.voiceSupport) {
                console.log('‚úÖ ResponsiveVoice loaded successfully');
                console.log('‚úÖ ResponsiveVoice support:', responsiveVoice.voiceSupport());
                return;
            }
            
            console.log(`‚è≥ ResponsiveVoice loading... (attempt ${rvCheckAttempts}/${maxRvAttempts})`);
            
            if (rvCheckAttempts < maxRvAttempts) {
                setTimeout(checkResponsiveVoice, 1000);
            } else {
                console.warn('‚ö†Ô∏è ResponsiveVoice failed to load after multiple attempts');
                console.log('üí° This means Arabic/Urdu will use browser voices only');
            }
        }
        
        // Start checking after a short delay
        setTimeout(checkResponsiveVoice, 1000);
    </script>

    <style>
        @keyframes typing {
            0% { opacity: 0; }
            50% { opacity: 1; }
            100% { opacity: 0; }
        }

        .typing-indicator {
            animation: typing 1.5s infinite;
        }

        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }

        .fade-out {
            animation: fadeOut 0.3s ease-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeOut {
            from {
                opacity: 1;
                transform: translateY(0);
            }
            to {
                opacity: 0;
                transform: translateY(-10px);
            }
        }

        .message-bubble {
            transition: all 0.3s ease;
        }

        .message-bubble:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .voice-recording {
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% {
                transform: scale(1);
                opacity: 1;
            }
            50% {
                transform: scale(1.1);
                opacity: 0.7;
            }
            100% {
                transform: scale(1);
                opacity: 1;
            }
        }

        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }

        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }

        ::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 3px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }

        /* Message content formatting */
        .message-content {
            line-height: 1.5;
        }

        .message-content p {
            margin: 0;
            padding: 0;
        }

        .message-content p + p {
            margin-top: 0.5rem;
        }

        .message-content ul, .message-content ol {
            margin: 0.5rem 0;
            padding-left: 1.5rem;
        }

        .message-content li {
            margin: 0.25rem 0;
        }

        .message-content code {
            background-color: rgba(0, 0, 0, 0.1);
            padding: 0.125rem 0.25rem;
            border-radius: 0.25rem;
            font-size: 0.875rem;
        }

        .message-content pre {
            background-color: rgba(0, 0, 0, 0.05);
            padding: 0.75rem;
            border-radius: 0.5rem;
            overflow-x: auto;
            margin: 0.5rem 0;
        }

        .message-content blockquote {
            border-left: 3px solid #e5e7eb;
            padding-left: 1rem;
            margin: 0.5rem 0;
            font-style: italic;
        }

        /* Dark theme styles */
        .dark-theme {
            background-color: #1a1a1a;
            color: #e5e7eb;
        }

        .dark-theme .bg-gray-50 {
            background-color: #111827 !important;
        }

        .dark-theme .bg-white {
            background-color: #1f2937 !important;
            color: #e5e7eb !important;
        }

        .dark-theme .bg-gray-100 {
            background-color: #374151 !important;
        }

        .dark-theme .bg-gray-200 {
            background-color: #4b5563 !important;
        }

        .dark-theme .bg-gray-300 {
            background-color: #6b7280 !important;
        }

        .dark-theme .border-gray-200 {
            border-color: #374151 !important;
        }

        .dark-theme .border-gray-300 {
            border-color: #4b5563 !important;
        }

        .dark-theme .text-gray-600 {
            color: #9ca3af !important;
        }

        .dark-theme .text-gray-700 {
            color: #d1d5db !important;
        }

        .dark-theme .text-gray-800 {
            color: #e5e7eb !important;
        }

        .dark-theme .text-gray-900 {
            color: #f9fafb !important;
        }

        .dark-theme .text-gray-500 {
            color: #6b7280 !important;
        }

        .dark-theme .text-gray-400 {
            color: #9ca3af !important;
        }

        .dark-theme .hover\:bg-gray-50:hover {
            background-color: #374151 !important;
        }

        .dark-theme .hover\:bg-gray-100:hover {
            background-color: #4b5563 !important;
        }

        .dark-theme .hover\:bg-gray-200:hover {
            background-color: #6b7280 !important;
        }

        .dark-theme .hover\:bg-gray-300:hover {
            background-color: #9ca3af !important;
        }

        .dark-theme .hover\:text-gray-600:hover {
            color: #d1d5db !important;
        }

        .dark-theme .hover\:text-gray-700:hover {
            color: #e5e7eb !important;
        }

        .dark-theme .hover\:bg-red-50:hover {
            background-color: #7f1d1d !important;
        }

        .dark-theme .hover\:bg-blue-50:hover {
            background-color: #1e3a8a !important;
        }

        /* Message bubbles in dark theme */
        .dark-theme .message-bubble {
            border-color: #374151;
        }

        .dark-theme .message-content code {
            background-color: rgba(255, 255, 255, 0.1);
        }

        .dark-theme .message-content pre {
            background-color: rgba(255, 255, 255, 0.05);
        }

        .dark-theme .message-content blockquote {
            border-left-color: #4b5563;
        }

        /* Scrollbar dark theme */
        .dark-theme ::-webkit-scrollbar-track {
            background: #374151;
        }

        .dark-theme ::-webkit-scrollbar-thumb {
            background: #6b7280;
        }

        .dark-theme ::-webkit-scrollbar-thumb:hover {
            background: #9ca3af;
        }

        /* Theme toggle button styles */
        .theme-toggle {
            transition: all 0.3s ease;
        }

        .theme-toggle:hover {
            transform: rotate(180deg);
        }

        /* Dark theme input and form elements */
        .dark-theme input[type="text"],
        .dark-theme input[type="email"],
        .dark-theme input[type="password"],
        .dark-theme textarea {
            background-color: #374151 !important;
            color: #f9fafb !important;
            border-color: #6b7280 !important;
        }

        .dark-theme input[type="text"]:focus,
        .dark-theme input[type="email"]:focus,
        .dark-theme input[type="password"]:focus,
        .dark-theme textarea:focus {
            background-color: #4b5563 !important;
            border-color: #3b82f6 !important;
            color: #f9fafb !important;
        }

        .dark-theme input::placeholder,
        .dark-theme textarea::placeholder {
            color: #9ca3af !important;
        }

        /* Dark theme button improvements */
        .dark-theme button {
            border-color: #4b5563 !important;
        }

        .dark-theme .bg-gray-200 {
            background-color: #4b5563 !important;
            color: #e5e7eb !important;
        }

        .dark-theme .hover\:bg-gray-300:hover {
            background-color: #6b7280 !important;
            color: #f9fafb !important;
        }

        /* Improve modal and overlay styling in dark mode */
        .dark-theme .bg-black {
            background-color: rgba(0, 0, 0, 0.8) !important;
        }

        /* Better contrast for disabled elements */
        .dark-theme button:disabled {
            background-color: #374151 !important;
            color: #6b7280 !important;
        }

        /* Improve text readability */
        .dark-theme .text-gray-600 {
            color: #d1d5db !important;
        }

        .dark-theme .text-gray-500 {
            color: #9ca3af !important;
        }

        /* Fix for specific input styling */
        .dark-theme #message-input {
            background-color: #374151 !important;
            color: #f9fafb !important;
            border-color: #6b7280 !important;
        }

        .dark-theme #message-input:focus {
            background-color: #4b5563 !important;
            border-color: #3b82f6 !important;
            color: #f9fafb !important;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1) !important;
        }

        .dark-theme #message-input::placeholder {
            color: #9ca3af !important;
        }

        /* Dark theme chat history improvements */
        .dark-theme .bg-blue-50 {
            background-color: #1e3a8a !important;
        }

        .dark-theme .border-blue-200 {
            border-color: #3b82f6 !important;
        }

        .dark-theme .hover\:bg-gray-50:hover {
            background-color: #374151 !important;
        }

        .dark-theme .text-gray-400 {
            color: #9ca3af !important;
        }

        .dark-theme .hover\:text-blue-500:hover {
            color: #60a5fa !important;
        }

        .dark-theme .hover\:text-red-500:hover {
            color: #f87171 !important;
        }

        /* Improve active chat styling in dark mode */
        .dark-theme .bg-blue-50 {
            background-color: #1e3a8a !important;
        }

        /* Better visibility for chat session items */
        .dark-theme .chat-session-item {
            border-color: #4b5563 !important;
        }

        .dark-theme .chat-session-item:hover {
            background-color: #374151 !important;
        }

        /* Improve message bubble styling */
        .dark-theme .bg-blue-100 {
            background-color: #1e3a8a !important;
        }

        .dark-theme .text-blue-700 {
            color: #93c5fd !important;
        }

        .dark-theme .hover\:bg-blue-200:hover {
            background-color: #1e40af !important;
        }

        .dark-theme .hover\:bg-gray-200:hover {
            background-color: #4b5563 !important;
        }

        .dark-theme .text-gray-700 {
            color: #d1d5db !important;
        }

        /* Fix for border colors */
        .dark-theme .border-gray-100 {
            border-color: #4b5563 !important;
        }

        /* Mobile optimizations */
        @media (max-width: 768px) {
            /* Prevent zoom on input focus */
            input[type="text"], textarea {
                font-size: 16px !important;
            }
            
            /* Ensure sidebar covers full screen on mobile */
            #sidebar {
                width: 100vw !important;
                max-width: 100vw !important;
            }
            
            /* Optimize touch targets */
            button {
                min-height: 44px;
                min-width: 44px;
            }
            
            /* Better text wrapping for RTL languages */
            .message-content {
                word-wrap: break-word;
                overflow-wrap: break-word;
                hyphens: auto;
            }
            
            /* Hide scrollbars on mobile for cleaner look */
            #chat-messages::-webkit-scrollbar,
            #chat-history::-webkit-scrollbar {
                display: none;
            }
            
            #chat-messages,
            #chat-history {
                -ms-overflow-style: none;
                scrollbar-width: none;
            }
            
            /* Improve mobile input area */
            #message-input {
                font-size: 16px !important;
            }
            
            /* Better mobile spacing */
            .chat-session-item {
                padding: 12px !important;
            }
        }

        /* iPad and tablet optimizations */
        @media (min-width: 769px) and (max-width: 1024px) {
            #sidebar {
                width: 300px;
            }
        }

        /* Ensure proper Arabic/Urdu text rendering */
        [dir="rtl"], .rtl {
            direction: rtl;
            text-align: right;
        }
        
        /* Better handling for mixed text */
        .message-content {
            unicode-bidi: plaintext;
        }

        /* Responsive font sizes */
        @media (max-width: 640px) {
            html {
                font-size: 14px;
            }
        }

        /* Enhanced button styles for dark theme */
        .dark-theme #logout-btn {
            background: linear-gradient(135deg, #374151, #4b5563) !important;
            border-color: #6b7280 !important;
        }

        .dark-theme #logout-btn:hover {
            background: linear-gradient(135deg, #7f1d1d, #991b1b) !important;
            border-color: #dc2626 !important;
        }

        .dark-theme #delete-account-btn {
            background: linear-gradient(135deg, #374151, #4b5563) !important;
            border-color: #6b7280 !important;
        }

        .dark-theme #delete-account-btn:hover {
            background: linear-gradient(135deg, #7f1d1d, #991b1b) !important;
            border-color: #dc2626 !important;
        }

        .dark-theme #toggle-sidebar-btn,
        .dark-theme #show-sidebar-btn,
        .dark-theme #hide-sidebar-btn {
            background: linear-gradient(135deg, #374151, #4b5563) !important;
            border-color: #6b7280 !important;
        }

        .dark-theme #toggle-sidebar-btn:hover,
        .dark-theme #show-sidebar-btn:hover,
        .dark-theme #hide-sidebar-btn:hover {
            background: linear-gradient(135deg, #4b5563, #6b7280) !important;
            border-color: #9ca3af !important;
        }

        .dark-theme #theme-toggle-btn {
            background: linear-gradient(135deg, #374151, #4b5563) !important;
            border-color: #6b7280 !important;
        }

        .dark-theme #download-pdf-btn,
        .dark-theme #auto-speak-btn {
            border-color: rgba(255, 255, 255, 0.2) !important;
        }

        .dark-theme #clear-chat-btn {
            background: #dc2626 !important; /* Keep red background */
            border-color: #ef4444 !important; /* Red border */
            color: white !important;
        }

        .dark-theme #clear-chat-btn:hover {
            background: #b91c1c !important; /* Darker red on hover */
            border-color: #f87171 !important; /* Lighter red border on hover */
        }

        /* Improve gradient button visibility in dark mode */
        .dark-theme .bg-gradient-to-r {
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3) !important;
        }

        .dark-theme .bg-gradient-to-r:hover {
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.4) !important;
        }

        /* Better icon colors in dark mode */
        .dark-theme svg {
            filter: brightness(1.1);
        }

        /* Enhance group hover effects in dark mode */
        .dark-theme .group:hover svg {
            transform: scale(1.05);
            transition: transform 0.2s ease;
        }

        /* Voice and Send button dark theme */
        .dark-theme #voice-btn:not(.voice-recording) {
            background: linear-gradient(135deg, #374151, #4b5563) !important;
            border-color: #6b7280 !important;
        }

        .dark-theme #voice-btn:not(.voice-recording):hover {
            background: linear-gradient(135deg, #4b5563, #6b7280) !important;
            border-color: #9ca3af !important;
        }

        .dark-theme #voice-btn:not(.voice-recording) svg {
            color: #9ca3af !important;
        }

        .dark-theme #voice-btn:not(.voice-recording):hover svg {
            color: #d1d5db !important;
        }

        .dark-theme #send-btn:not(:disabled) {
            border-color: rgba(99, 102, 241, 0.5) !important;
        }

        /* Mobile responsiveness improvements */
        @media (max-width: 640px) {
            /* Ensure buttons remain touch-friendly */
            .group {
                min-height: 44px;
                min-width: 44px;
            }
            
            /* Better spacing for mobile buttons */
            .space-x-1\.5 > * + * {
                margin-left: 8px !important;
            }
            
                         /* Optimize gradient buttons for mobile */
             .bg-gradient-to-r,
             .bg-gradient-to-br {
                 box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1) !important;
             }
         }

         /* Enhanced chat action buttons */
         .rename-chat-btn, .delete-chat-btn {
             position: relative;
             overflow: hidden;
         }

         .rename-chat-btn::before, .delete-chat-btn::before {
             content: '';
             position: absolute;
             top: 0;
             left: -100%;
             width: 100%;
             height: 100%;
             background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
             transition: left 0.5s ease;
         }

         .rename-chat-btn:hover::before, .delete-chat-btn:hover::before {
             left: 100%;
         }

         /* Dark theme support for chat action buttons */
         .dark-theme .rename-chat-btn {
             background: linear-gradient(135deg, #1e3a8a, #3730a3) !important;
             border-color: #3b82f6 !important;
             color: #93c5fd !important;
         }

         .dark-theme .rename-chat-btn:hover {
             background: linear-gradient(135deg, #1e40af, #4338ca) !important;
             border-color: #60a5fa !important;
             box-shadow: 0 4px 6px rgba(59, 130, 246, 0.2) !important;
         }

         .dark-theme .rename-chat-btn svg {
             color: #93c5fd !important;
         }

         .dark-theme .rename-chat-btn:hover svg {
             color: #dbeafe !important;
         }

         .dark-theme .delete-chat-btn {
             background: linear-gradient(135deg, #7f1d1d, #991b1b) !important;
             border-color: #dc2626 !important;
             color: #fca5a5 !important;
         }

         .dark-theme .delete-chat-btn:hover {
             background: linear-gradient(135deg, #991b1b, #b91c1c) !important;
             border-color: #f87171 !important;
             box-shadow: 0 4px 6px rgba(239, 68, 68, 0.2) !important;
         }

         .dark-theme .delete-chat-btn svg {
             color: #fca5a5 !important;
         }

         .dark-theme .delete-chat-btn:hover svg {
             color: #fee2e2 !important;
         }

         /* Chat session improvements */
         .chat-session-item {
             position: relative;
             overflow: hidden;
         }

         .chat-session-item::before {
             content: '';
             position: absolute;
             top: 0;
             left: -100%;
             width: 100%;
             height: 100%;
             background: linear-gradient(90deg, transparent, rgba(59, 130, 246, 0.1), transparent);
             transition: left 0.8s ease;
         }

         .chat-session-item:hover::before {
             left: 100%;
         }

         /* Better mobile touch targets for action buttons */
         @media (max-width: 768px) {
             .rename-chat-btn, .delete-chat-btn {
                 padding: 8px !important;
                 min-width: 36px;
                 min-height: 36px;
             }

                           .rename-chat-btn svg, .delete-chat-btn svg {
                  width: 16px !important;
                  height: 16px !important;
              }
          }

          /* Enhanced rename input field */
          .chat-title-input {
              backdrop-filter: blur(10px);
          }

          .dark-theme .chat-title-input {
              background-color: #374151 !important;
              color: #f9fafb !important;
              border-color: #3b82f6 !important;
          }

          .dark-theme .chat-title-input:focus {
              background-color: #4b5563 !important;
              border-color: #60a5fa !important;
              box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1) !important;
          }

          /* Enhanced chat session active state in dark mode */
          .dark-theme .chat-session-item[class*="bg-gradient-to-r"] {
              background: linear-gradient(to right, #1e3a8a, #3730a3) !important;
              border-color: #3b82f6 !important;
          }

          .dark-theme .chat-session-item:hover {
              background-color: #374151 !important;
              border-color: #6b7280 !important;
          }

          /* Add subtle animation to action buttons */
          .rename-chat-btn svg, .delete-chat-btn svg {
              transition: all 0.2s ease;
          }

          .rename-chat-btn:hover svg {
              transform: scale(1.1) rotate(5deg);
          }

          .delete-chat-btn:hover svg {
              transform: scale(1.1) rotate(-5deg);
          }

          /* Loading state for buttons */
                     .rename-chat-btn:active, .delete-chat-btn:active {
               transform: scale(0.95);
               transition: transform 0.1s ease;
           }

           /* Scrollbar hiding utility */
           .scrollbar-hide {
               -ms-overflow-style: none;  /* Internet Explorer 10+ */
               scrollbar-width: none;  /* Firefox */
           }
           .scrollbar-hide::-webkit-scrollbar {
               display: none;  /* Safari and Chrome */
           }

           /* Header button container improvements */
           .overflow-x-auto {
               scroll-behavior: smooth;
               -webkit-overflow-scrolling: touch;
           }

           /* Mobile UI Improvements */
           @media (max-width: 640px) {
               /* Phone specific optimizations */
               #logout-btn {
                   padding: 8px !important;
                   min-width: 36px !important;
                   min-height: 36px !important;
               }

               #logout-btn svg {
                   width: 16px !important;
                   height: 16px !important;
               }

               /* Fix mobile layout breakage */
               .flex-1.flex.flex-col {
                   width: 100% !important;
                   min-width: 0 !important;
               }

               /* Header button container mobile scrolling - improved spacing */
               .overflow-x-auto.scrollbar-hide {
                   padding-right: 12px !important;
                   max-width: calc(100vw - 100px) !important;
                   flex-shrink: 1 !important;
                   gap: 6px !important;
               }

               /* Header buttons mobile sizing - better spacing and sizing */
               #theme-toggle-btn, #download-pdf-btn, #auto-speak-btn, #clear-chat-btn {
                   padding: 8px 10px !important;
                   min-width: 44px !important;
                   min-height: 36px !important;
                   white-space: nowrap !important;
                   flex-shrink: 0 !important;
                   font-size: 12px !important;
                   border-radius: 8px !important;
                   margin-right: 4px !important;
               }

               #theme-toggle-btn {
                   padding: 8px !important;
                   min-width: 36px !important;
                   margin-right: 6px !important;
               }

               /* Hide text labels on mobile for more space */
               #download-pdf-btn span,
               #auto-speak-btn span,
               #clear-chat-btn span {
                   display: none !important;
               }

               /* Ensure icons are properly sized on mobile */
               #theme-toggle-btn svg,
               #download-pdf-btn svg,
               #auto-speak-btn svg,
               #clear-chat-btn svg {
                   width: 16px !important;
                   height: 16px !important;
               }

               /* Chat header mobile layout - improved spacing */
               .bg-white.border-b.border-gray-200 {
                   padding: 10px 8px !important;
                   min-height: 56px !important;
               }

               /* Chat header content mobile - better spacing */
               .flex.items-center.space-x-2 {
                   gap: 6px !important;
                   width: 100% !important;
                   align-items: center !important;
               }

               /* Mobile header button spacing override */
               .space-x-1 > * + * {
                   margin-left: 0 !important;
               }

               .min-w-0.flex-1 {
                   flex: 1 !important;
                   min-width: 0 !important;
                   overflow: hidden !important;
               }

               /* Chat area mobile */
               #chat-messages {
                   padding: 12px !important;
                   height: calc(100vh - 180px) !important;
                   overflow-y: auto !important;
               }

               /* Input area mobile */
               .bg-white.border-t.border-gray-200:last-child {
                   padding: 12px !important;
               }

               /* Chat action buttons always visible on mobile */
               .chat-session-item .flex.items-center.space-x-1\.5 {
                   opacity: 1 !important;
               }

               /* Better mobile chat buttons */
               .rename-chat-btn, .delete-chat-btn {
                   padding: 6px !important;
                   min-width: 28px !important;
                   min-height: 28px !important;
               }

               .rename-chat-btn svg, .delete-chat-btn svg {
                   width: 12px !important;
                   height: 12px !important;
               }

               /* Message action buttons mobile */
               .group\/speak, .group\/copy {
                   padding: 6px 8px !important;
                   font-size: 11px !important;
               }

               .group\/speak svg, .group\/copy svg {
                   width: 14px !important;
                   height: 14px !important;
               }

               /* Sidebar improvements */
               #new-chat-btn {
                   padding: 8px 10px !important;
                   font-size: 13px !important;
               }

               #delete-account-btn {
                   padding: 10px !important;
               }

               #delete-account-btn .w-8 {
                   width: 24px !important;
                   height: 24px !important;
               }

               #delete-account-btn svg {
                   width: 12px !important;
                   height: 12px !important;
               }

               /* Voice and send buttons mobile */
               #voice-btn, #send-btn {
                   width: 40px !important;
                   height: 40px !important;
                   flex-shrink: 0 !important;
               }

               #voice-btn svg, #send-btn svg {
                   width: 20px !important;
                   height: 20px !important;
               }

               /* Input field mobile */
               #message-input {
                   padding: 10px 12px !important;
                   font-size: 14px !important;
               }

               /* Mobile sidebar overlay */
               #sidebar {
                   width: 280px !important;
                   max-width: 85vw !important;
               }
           }

           /* Tablet UI Improvements */
           @media (min-width: 641px) and (max-width: 1024px) {
               /* Show action buttons on hover for tablets */
               .chat-session-item .flex.items-center.space-x-1\.5 {
                   opacity: 1 !important;
               }

               /* Header button container tablet scrolling */
               .overflow-x-auto.scrollbar-hide {
                   padding-right: 12px !important;
                   max-width: calc(100vw - 200px) !important;
               }

               /* Header buttons tablet sizing */
               #theme-toggle-btn, #download-pdf-btn, #auto-speak-btn, #clear-chat-btn {
                   padding: 8px 10px !important;
                   min-width: auto !important;
                   white-space: nowrap !important;
                   flex-shrink: 0 !important;
               }

               #theme-toggle-btn {
                   padding: 10px !important;
                   min-width: 40px !important;
               }

               /* Chat header tablet layout */
               .bg-white.border-b.border-gray-200 {
                   padding: 12px 16px !important;
                   min-height: 70px !important;
               }

               /* Chat area tablet */
               #chat-messages {
                   padding: 16px !important;
                   height: calc(100vh - 200px) !important;
               }

               /* Tablet chat action buttons */
               .rename-chat-btn, .delete-chat-btn {
                   padding: 8px !important;
                   min-width: 32px !important;
                   min-height: 32px !important;
               }

               .rename-chat-btn svg, .delete-chat-btn svg {
                   width: 14px !important;
                   height: 14px !important;
               }

               /* Message buttons tablet optimization */
               .group\/speak, .group\/copy {
                   padding: 8px 12px !important;
               }

               .group\/speak svg, .group\/copy svg {
                   width: 16px !important;
                   height: 16px !important;
               }

               /* Better sidebar width for tablets */
               #sidebar {
                   width: 300px !important;
               }

               /* Logout button tablet sizing */
               #logout-btn {
                   padding: 10px !important;
                   min-width: 40px !important;
                   min-height: 40px !important;
               }

               #logout-btn svg {
                   width: 18px !important;
                   height: 18px !important;
               }

               /* Voice and send buttons tablet */
               #voice-btn, #send-btn {
                   width: 48px !important;
                   height: 48px !important;
               }

               #voice-btn svg, #send-btn svg {
                   width: 24px !important;
                   height: 24px !important;
               }

               /* Input field tablet */
               #message-input {
                   padding: 12px 16px !important;
                   font-size: 15px !important;
               }
           }

           /* Tablet specific optimizations */
           @media (min-width: 769px) and (max-width: 1024px) {
               /* Logout button tablet sizing */
               #logout-btn {
                   padding: 12px !important;
                   min-width: 44px !important;
                   min-height: 44px !important;
               }

               #logout-btn svg {
                   width: 20px !important;
                   height: 20px !important;
               }

               /* Better sidebar width for tablets */
               #sidebar {
                   width: 280px !important;
               }

               /* Tablet chat session spacing */
               .chat-session-item {
                   padding: 14px !important;
                   margin-bottom: 8px !important;
               }

               /* Tablet action buttons */
               .rename-chat-btn, .delete-chat-btn {
                   padding: 8px !important;
                   min-width: 32px !important;
                   min-height: 32px !important;
               }

               .rename-chat-btn svg, .delete-chat-btn svg {
                   width: 14px !important;
                   height: 14px !important;
               }
           }

           /* Consistent button centering across all screen sizes */
           #logout-btn, #toggle-sidebar-btn, #show-sidebar-btn, #hide-sidebar-btn {
               display: flex !important;
               align-items: center !important;
               justify-content: center !important;
           }

           /* Ensure icons are always centered */
           button svg {
               display: block;
               margin: auto;
           }

           /* Touch-friendly interactions */
           @media (hover: none) and (pointer: coarse) {
               /* Mobile touch devices */
               .group:hover {
                   /* Disable hover effects on touch devices */
               }

               /* Add active states for touch */
               .group:active {
                   transform: scale(0.95);
                   transition: transform 0.1s ease;
               }

               /* Better touch targets */
               button {
                   min-width: 44px !important;
                   min-height: 44px !important;
               }
           }

           /* Improve text truncation on small screens */
           @media (max-width: 640px) {
               .truncate {
                   max-width: 150px !important;
               }

               /* Better user name display */
               .user-info {
                   max-width: 140px !important;
               }

               .user-info h2,
               .user-info p {
                   overflow: hidden !important;
                   text-overflow: ellipsis !important;
                   white-space: nowrap !important;
               }
           }
    </style>
</head>

<body class="bg-gray-100 min-h-screen">
    <div id="app"></div>

    <!-- Load configuration first -->
    <script src="config.js?v=10"></script>
    
    <!-- Embedded CONFIG as fallback -->
    <script>
        // Ensure CONFIG object is always available
        if (typeof CONFIG === 'undefined') {
            console.log('üîÑ Creating embedded CONFIG object...');
            window.CONFIG = {
                GEMINI_API_KEY: 'AIzaSyB-mECJerfCzwB9JUO4cp0EJxmIzl6dq0g',
                GEMINI_API_URL: 'https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent',
                MONGODB_URI: 'mongodb+srv://keswani399:270778eshnali@cluster0.fvmbrtz.mongodb.net/?retryWrites=true&w=majority&appName=Cluster0',
                MONGODB_OPTIONS: {
                    useNewUrlParser: true,
                    useUnifiedTopology: true,
                    maxPoolSize: 10,
                    serverSelectionTimeoutMS: 5000,
                    socketTimeoutMS: 45000,
                },
                AUTO_SPEAK_AI_RESPONSES: true,
                AUTO_SAVE_INTERVAL: 30000,
                MAX_MESSAGE_LENGTH: 1000,
                VOICE_RATE: 0.9,
                VOICE_PITCH: 1,
                VOICE_VOLUME: 1.0,
                VOICE_LANG: 'en-US'
            };
            console.log('‚úÖ Embedded CONFIG object created');
        } else {
            // Ensure CONFIG is also on window object
            window.CONFIG = CONFIG;
        }
        
        console.log('üîç CONFIG check after loading:');
        console.log('  - CONFIG exists:', typeof CONFIG !== 'undefined');
        console.log('  - window.CONFIG exists:', typeof window.CONFIG !== 'undefined');
        console.log('  - CONFIG.GEMINI_API_KEY exists:', !!CONFIG?.GEMINI_API_KEY);
        console.log('  - API Key value:', CONFIG?.GEMINI_API_KEY);
        console.log('  - API Key length:', CONFIG?.GEMINI_API_KEY?.length);
        console.log('  - API Key starts with AIza:', CONFIG?.GEMINI_API_KEY?.startsWith('AIza'));
    </script>
    
    <!-- Load utility functions -->
    <script src="utils/helpers.js?v=10"></script>
    <script>
        if (typeof utils === 'undefined') {
            console.error('‚ùå utils not loaded properly');
        } else {
            console.log('‚úÖ utils loaded successfully');
        }
    </script>
    
    <!-- Load services -->
    <script src="services/databaseService.js?v=23"></script>
    <script>
        if (typeof databaseService === 'undefined') {
            console.error('‚ùå databaseService not loaded properly');
        } else {
            console.log('‚úÖ databaseService loaded successfully');
        }
    </script>
    
    <script src="services/authService.js?v=11"></script>
    <script>
        if (typeof authService === 'undefined') {
            console.error('‚ùå authService not loaded properly');
        } else {
            console.log('‚úÖ authService loaded successfully');
        }
    </script>
    
    <script src="services/aiService.js?v=20"></script>
    <script>
        if (typeof aiService === 'undefined') {
            console.error('‚ùå aiService not loaded properly');
        } else {
            console.log('‚úÖ aiService loaded successfully');
        }
    </script>
    
    <script src="services/voiceService_new.js?v=1"></script>
    <script>
        if (typeof voiceService === 'undefined') {
            console.error('‚ùå voiceService not loaded properly');
        } else {
            console.log('‚úÖ NEW voiceService loaded successfully');
        }
        
        // Debug functions for Arabic and Urdu testing
        window.testArabicVoice = function() {
            console.log('üß™ Testing Arabic Voice...');
            const arabicText = 'ŸÖÿ±ÿ≠ÿ®ÿßŸãÿå ŸÉŸäŸÅ ÿ≠ÿßŸÑŸÉ ÿßŸÑŸäŸàŸÖÿü';
            
            console.log('Text:', arabicText);
            console.log('Has Arabic script:', /[\u0600-\u06FF]/.test(arabicText));
            
            if (typeof voiceService !== 'undefined') {
                // Clear any cached wrong voice for Arabic
                voiceService.clearLanguageCache('ar-SA');
                
                const detected = voiceService.detectLanguage(arabicText);
                console.log('Detected language:', detected);
                
                console.log('ResponsiveVoice available:', typeof responsiveVoice !== 'undefined' && responsiveVoice.voiceSupport());
                
                voiceService.speak(arabicText, detected)
                    .then(() => console.log('‚úÖ Arabic speech completed'))
                    .catch(error => console.error('‚ùå Arabic speech failed:', error));
            } else {
                console.error('‚ùå voiceService not available');
            }
        };
        
        window.testUrduVoice = function() {
            console.log('üß™ Testing Urdu Voice...');
            const urduText = 'ÿ¢Ÿæ ÿ¢ÿ¨ ⁄©€åÿ≥€í €Å€å⁄∫ÿü';
            
            console.log('Text:', urduText);
            console.log('Has Arabic script:', /[\u0600-\u06FF]/.test(urduText));
            console.log('Has Urdu markers:', /[€å€Å⁄∫Ÿæ⁄Ü⁄Ø⁄©⁄ë]/.test(urduText) || /\b(€å€Å|€Å€í|ŸÖ€å⁄∫|⁄©ÿß|⁄©€å|ÿ≥€í|⁄©Ÿà|ÿßŸàÿ±|ÿ¢Ÿæ|ÿ™ŸÖ|Ÿà€Å)\b/.test(urduText));
            
            if (typeof voiceService !== 'undefined') {
                // Clear any cached wrong voice for Urdu
                voiceService.clearLanguageCache('ur-PK');
                
                const detected = voiceService.detectLanguage(urduText);
                console.log('Detected language:', detected);
                
                console.log('ResponsiveVoice available:', typeof responsiveVoice !== 'undefined' && responsiveVoice.voiceSupport());
                
                voiceService.speak(urduText, detected)
                    .then(() => console.log('‚úÖ Urdu speech completed'))
                    .catch(error => console.error('‚ùå Urdu speech failed:', error));
            } else {
                console.error('‚ùå voiceService not available');
            }
        };
        
        // Additional debug function
        window.clearVoiceCache = function() {
            if (typeof voiceService !== 'undefined') {
                voiceService.clearVoiceCache();
                console.log('‚úÖ All voice caches cleared');
            }
        };
        
        // Additional test function for Google TTS
        window.testGoogleTTS = function() {
            console.log('üß™ Testing Google TTS directly...');
            const arabicText = 'ŸÖÿ±ÿ≠ÿ®ÿßŸãÿå ŸÉŸäŸÅ ÿ≠ÿßŸÑŸÉ ÿßŸÑŸäŸàŸÖÿü';
            
            if (typeof voiceService !== 'undefined' && voiceService.useGoogleTranslateTTS) {
                voiceService.useGoogleTranslateTTS(arabicText, 'ar', () => {
                    console.log('‚úÖ Google TTS test completed');
                });
            } else {
                console.error('‚ùå Google TTS not available');
            }
        };
        
        // Log available commands
        console.log('üîß Debug Functions Available:');
        console.log('  - testArabicVoice()');
        console.log('  - testUrduVoice()');
        console.log('  - testGoogleTTS()');
        console.log('  - clearVoiceCache()');
    </script>
    
    <script src="services/mongoService.js?v=10"></script>
    <script>
        if (typeof mongoService === 'undefined') {
            console.error('‚ùå mongoService not loaded properly');
        } else {
            console.log('‚úÖ mongoService loaded successfully');
        }
    </script>
    
    <!-- Load components -->
    <script src="components/Component.js?v=10"></script>
    <script>
        if (typeof Component === 'undefined') {
            console.error('‚ùå Component not loaded properly');
        } else {
            console.log('‚úÖ Component loaded successfully');
        }
    </script>
    
    <script src="components/LoginForm.js?v=10"></script>
    <script>
        if (typeof LoginForm === 'undefined') {
            console.error('‚ùå LoginForm not loaded properly');
                } else {
            console.log('‚úÖ LoginForm loaded successfully');
        }
    </script>
    
    <script src="components/ChatApp.js?v=30"></script>
    <script>
        if (typeof ChatApp === 'undefined') {
            console.error('‚ùå ChatApp not loaded properly');
                } else {
            console.log('‚úÖ ChatApp loaded successfully');
        }
    </script>
    
    <script src="components/App.js?v=10"></script>
    <script>
        if (typeof App === 'undefined') {
            console.error('‚ùå App not loaded properly');
        } else {
            console.log('‚úÖ App loaded successfully');
        }
    </script>

    <!-- Main application script -->
    <script>
        // Verify all required services are loaded
        function verifyServices() {
            const required = [
                'CONFIG', 'utils', 'databaseService', 'authService', 
                'aiService', 'voiceService', 'mongoService', 'App'
            ];
            
            const missing = [];
            
            required.forEach(service => {
                let exists = false;
                
                // Special handling for CONFIG object
                if (service === 'CONFIG') {
                    exists = typeof CONFIG !== 'undefined';
                } else {
                    exists = typeof window[service] !== 'undefined';
                }
                
                if (!exists) {
                    missing.push(service);
                }
            });
            
            if (missing.length > 0) {
                console.error('‚ùå Missing required services:', missing);
                return false;
            }
            
            console.log('‚úÖ All required services loaded successfully');
            return true;
        }

        // Initialize the application
        document.addEventListener('DOMContentLoaded', async function() {
            console.log('üöÄ Starting AI Chatbot Application...');
            
            // Wait a bit for all scripts to load
            await new Promise(resolve => setTimeout(resolve, 100));
            
            // Test all global objects individually
            console.log('üîç Testing global objects:');
            console.log('  - CONFIG:', typeof CONFIG !== 'undefined' ? '‚úÖ' : '‚ùå');
            console.log('  - window.CONFIG:', typeof window.CONFIG !== 'undefined' ? '‚úÖ' : '‚ùå');
            console.log('  - utils:', typeof utils !== 'undefined' ? '‚úÖ' : '‚ùå');
            console.log('  - databaseService:', typeof databaseService !== 'undefined' ? '‚úÖ' : '‚ùå');
            console.log('  - authService:', typeof authService !== 'undefined' ? '‚úÖ' : '‚ùå');
            console.log('  - aiService:', typeof aiService !== 'undefined' ? '‚úÖ' : '‚ùå');
            console.log('  - voiceService:', typeof voiceService !== 'undefined' ? '‚úÖ' : '‚ùå');
            console.log('  - mongoService:', typeof mongoService !== 'undefined' ? '‚úÖ' : '‚ùå');
            console.log('  - App:', typeof App !== 'undefined' ? '‚úÖ' : '‚ùå');
            
            // Verify all services are loaded
            if (!verifyServices()) {
                console.error('‚ùå Application initialization failed - missing services');
                console.log('üîÑ Retrying in 1 second...');
                
                // Retry after 1 second
                setTimeout(async () => {
                    if (!verifyServices()) {
                        console.error('‚ùå Application initialization failed after retry');
                        return;
                    }
                    await initializeApp();
                }, 1000);
                return;
            }
            
            await initializeApp();
        });
        
        // Separate initialization function
        async function initializeApp() {
            // Initialize theme first
            console.log('üé® Initializing theme...');
            utils.initTheme();
            
            // TEMPORARY: Clear only chat data to fix duplication issue
            console.log('üßπ Clearing chat data to fix duplicates...');
            localStorage.removeItem('chatbot_chats');
            console.log('‚úÖ Chat data cleared');
            
            // Add global error handlers
            window.addEventListener('error', (event) => {
                console.error('Global JavaScript error:', event.error);
                console.error('Error details:', {
                    message: event.message,
                    filename: event.filename,
                    lineno: event.lineno,
                    colno: event.colno
                });
                
                // Show user-friendly error message
                if (window.utils && window.utils.showToast) {
                    window.utils.showToast('An error occurred. Chat should continue working.', 'warning');
                }
            });

            window.addEventListener('unhandledrejection', (event) => {
                console.error('Unhandled promise rejection:', event.reason);
                
                // Show user-friendly error message
                if (window.utils && window.utils.showToast) {
                    window.utils.showToast('A network error occurred. Please try again.', 'warning');
                }
                
                // Prevent the default behavior (logging to console)
                event.preventDefault();
            });

            // Initialize MongoDB connection
            try {
                const mongoConnected = await mongoService.connect();
                if (mongoConnected) {
                    console.log('‚úÖ MongoDB connected successfully!');
                    
                    // Migrate existing local data to MongoDB if needed
                    if (databaseService.users.length > 0) {
                        console.log('üîÑ Migrating local data to MongoDB...');
                        await mongoService.migrateFromLocalStorage(
                            databaseService.users, 
                            databaseService.chats
                        );
                    }
                } else {
                    console.log('‚ÑπÔ∏è Using local storage (MongoDB not configured)');
                }
            } catch (error) {
                console.error('‚ùå MongoDB initialization failed:', error);
                console.log('‚ÑπÔ∏è Continuing with local storage...');
            }

            // Create demo user if no users exist
            if (databaseService.users.length === 0) {
                const demoUser = databaseService.createUser({
                    name: 'Demo User',
                    email: 'demo@example.com',
                    password: 'demo123'
                });

                // Add some demo messages
                databaseService.addMessage(demoUser.id, {
                    type: 'user',
                    content: 'Hello! Can you help me understand how this chatbot works?'
                });

                databaseService.addMessage(demoUser.id, {
                        type: 'ai',
                    content: 'Hello! I\'d be happy to help you understand how this chatbot works. This is a demonstration AI chatbot with the following features:\n\n‚Ä¢ Real-time chat interface with message history\n‚Ä¢ Voice input using speech recognition\n‚Ä¢ Text-to-speech for AI responses\n‚Ä¢ Copy messages to clipboard\n‚Ä¢ Export chat history as PDF, TXT, or JSON\n‚Ä¢ User authentication and secure login\n‚Ä¢ MongoDB integration for cloud storage\n‚Ä¢ Responsive design that works on mobile and desktop\n\nYou can interact with me by typing messages, using voice input (click the microphone), or asking me questions about various topics. Try asking me something!'
                });
            }

            // Initialize the main app
            window.app = new App();
            window.app.render();

        // Handle browser back/forward
        window.addEventListener('popstate', () => {
                window.app.render();
        });

            // Auto-save chat messages periodically
        setInterval(() => {
            if (authService.isAuthenticated()) {
                    databaseService.saveChats();
            }
            }, CONFIG.AUTO_SAVE_INTERVAL);

        // Handle page visibility change to stop speech when tab is not active
        document.addEventListener('visibilitychange', () => {
            if (document.hidden) {
                // Use the new stopAllAudio method for consistent audio stopping
                if (window.app && window.app.chatApp && window.app.chatApp.stopAllAudio) {
                    window.app.chatApp.stopAllAudio();
                } else {
                    // Fallback to direct service calls
                voiceService.stopSpeaking();
                voiceService.stopListening();
                }
            }
        });

        // Handle window blur/focus events for better audio control
        window.addEventListener('blur', () => {
            // Stop audio when window loses focus
            if (window.app && window.app.chatApp && window.app.chatApp.stopAllAudio) {
                window.app.chatApp.stopAllAudio();
            }
        });

        window.addEventListener('focus', () => {
            // Optional: Could add focus-related logic here if needed
            console.log('üéØ Window gained focus');
        });

        // Service Worker for offline functionality (basic)
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('data:text/javascript,')
                .then(() => console.log('Service Worker registered'))
                .catch(() => console.log('Service Worker registration failed'));
        }

            console.log('‚úÖ AI Chatbot Application Loaded Successfully!');
            console.log('üéØ Demo Login: demo@example.com / demo123');
            
            // Check API key configuration and test connection
            const apiStatus = aiService.getApiStatus();
            if (!apiStatus.isConfigured) {
                console.warn('‚ö†Ô∏è Please configure your Gemini API key in config.js to enable AI responses.');
                utils.showToast('Please configure your Gemini API key in config.js', 'warning');
            } else {
                console.log('‚úÖ Gemini API key is properly configured');
                console.log('üîë API Key:', apiStatus.apiKey);
                
                // Test the API connection
                const isWorking = await aiService.testConnection();
                if (isWorking) {
                    console.log('üéâ Gemini API is working correctly!');
                    utils.showToast('Gemini API connected successfully!', 'success');
                } else {
                    console.warn('‚ö†Ô∏è API key is configured but connection test failed');
                    utils.showToast('API key configured but connection failed. Check your internet.', 'warning');
                }
            }

            // Check MongoDB configuration
            if (!CONFIG.MONGODB_URI || CONFIG.MONGODB_URI.includes('username:password')) {
                console.warn('‚ö†Ô∏è MongoDB URI not configured. Using local storage only.');
                console.log('üìñ See MONGODB_SETUP.md for setup instructions.');
            }
        }

        // Graceful shutdown
        window.addEventListener('beforeunload', async () => {
            if (mongoService && mongoService.isConnected) {
                await mongoService.disconnect();
            }
        });
    </script>
</body>

</html>