<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Voice Service Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background: #0056b3;
        }
        .stop-btn {
            background: #dc3545;
        }
        .stop-btn:hover {
            background: #c82333;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
            background: #e9ecef;
        }
        input[type="text"] {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
        }
    </style>
</head>
<body>
    <h1>🎤 Voice Service Test</h1>
    
    <div class="test-section">
        <h2>Quick Tests</h2>
        <button onclick="testEnglish()">Test English</button>
        <button onclick="testSpanish()">Test Spanish</button>
        <button onclick="testFrench()">Test French</button>
        <button onclick="testGerman()">Test German</button>
        <button class="stop-btn" onclick="stopAll()">🛑 STOP ALL</button>
    </div>
    
    <div class="test-section">
        <h2>Custom Test</h2>
        <input type="text" id="customText" placeholder="Enter text to speak..." value="Hello, this is a test of the voice system">
        <select id="languageSelect">
            <option value="en-US">English</option>
            <option value="es-ES">Spanish</option>
            <option value="fr-FR">French</option>
            <option value="de-DE">German</option>
            <option value="hi-IN">Hindi</option>
            <option value="ar-SA">Arabic</option>
            <option value="zh-CN">Chinese</option>
        </select>
        <br>
        <button onclick="testCustom()">Speak Custom Text</button>
        <button class="stop-btn" onclick="stopAll()">Stop</button>
    </div>
    
    <div class="test-section">
        <h2>Consistency Test</h2>
        <p>Click the same button multiple times to test voice consistency:</p>
        <button onclick="testSpanishConsistency()">Spanish: "Hola, ¿cómo estás?"</button>
        <button onclick="testSpanishConsistency()">Spanish: "Hola, ¿cómo estás?"</button>
        <button onclick="testSpanishConsistency()">Spanish: "Hola, ¿cómo estás?"</button>
        <br><small>Should use the same voice every time</small>
    </div>
    
    <div class="test-section">
        <h2>Stop Test</h2>
        <p>Test stopping audio mid-speech:</p>
        <button onclick="testLongSpeech()">Start Long Speech</button>
        <button class="stop-btn" onclick="stopAll()">Stop Immediately</button>
        <br><small>Should stop immediately when clicked</small>
    </div>
    
    <div class="status" id="status">
        Ready to test...
    </div>

    <!-- Load ResponsiveVoice -->
    <script src="https://code.responsivevoice.org/responsivevoice.js?key=FREE"></script>
    
    <!-- Load our voice service -->
    <script src="services/voiceService_new.js"></script>

    <script>
        function updateStatus(message) {
            document.getElementById('status').textContent = message;
            console.log(message);
        }

        function testEnglish() {
            updateStatus('Testing English...');
            voiceService.speak("Hello, this is a test of the English voice system.", { lang: 'en-US' })
                .then(() => updateStatus('English test completed'));
        }

        function testSpanish() {
            updateStatus('Testing Spanish...');
            voiceService.speak("Hola, este es una prueba del sistema de voz en español.", { lang: 'es-ES' })
                .then(() => updateStatus('Spanish test completed'));
        }

        function testFrench() {
            updateStatus('Testing French...');
            voiceService.speak("Bonjour, ceci est un test du système vocal français.", { lang: 'fr-FR' })
                .then(() => updateStatus('French test completed'));
        }

        function testGerman() {
            updateStatus('Testing German...');
            voiceService.speak("Hallo, dies ist ein Test des deutschen Sprachsystems.", { lang: 'de-DE' })
                .then(() => updateStatus('German test completed'));
        }

        function testCustom() {
            const text = document.getElementById('customText').value;
            const lang = document.getElementById('languageSelect').value;
            updateStatus(`Testing custom: ${lang}...`);
            voiceService.speak(text, { lang })
                .then(() => updateStatus('Custom test completed'));
        }

        function testSpanishConsistency() {
            updateStatus('Testing Spanish consistency...');
            voiceService.speak("Hola, ¿cómo estás? Esta es una prueba de consistencia.", { lang: 'es-ES' })
                .then(() => updateStatus('Spanish consistency test completed'));
        }

        function testLongSpeech() {
            const longText = "This is a very long speech test to see if we can stop the audio properly in the middle of speaking. The voice service should be able to stop this immediately when the stop button is clicked. This text is intentionally long so you have time to test the stop functionality. Keep listening and then click the stop button to test if it works correctly.";
            updateStatus('Starting long speech...');
            voiceService.speak(longText, { lang: 'en-US' })
                .then(() => updateStatus('Long speech completed (or stopped)'));
        }

        function stopAll() {
            updateStatus('Stopping all audio...');
            voiceService.stopAll();
            updateStatus('All audio stopped');
        }

        // Test on page load
        window.addEventListener('load', () => {
            updateStatus('Voice service loaded and ready for testing!');
            
            // Show available voices in console
            setTimeout(() => {
                if (speechSynthesis && speechSynthesis.getVoices) {
                    const voices = speechSynthesis.getVoices();
                    console.log('Available voices:', voices.length);
                    voices.forEach((voice, i) => {
                        console.log(`${i + 1}. ${voice.name} (${voice.lang})`);
                    });
                }
            }, 1000);
        });
    </script>
</body>
</html> 